--36. Classify customers based on their total order amounts such that total
--order amounts > 5000 should be classified as ‘High Value’, if > 1000 then
--as ‘Medium Value’ and otherwise as ‘Low Value’
SELECT CUSTOMERS.COMPANY_NAME,
SUM(QUANTITY * UNIT_PRICE) AS COST,
CASE
WHEN SUM(QUANTITY * UNIT_PRICE) > 5000 
THEN 'HIGH_VALUE'
WHEN SUM(QUANTITY * UNIT_PRICE) > 1000 
THEN 'MEDIUM_VALUE'
ELSE 'LOW_VALUE'
END AS CUSTOMER_CLASS
FROM CUSTOMERS
INNER JOIN ORDERS 
ON CUSTOMERS.CUSTOMER_ID = ORDERS.CUSTOMER_ID
INNER JOIN ORDER_DETAILS
ON ORDERS.ORDER_ID = ORDER_DETAILS.ORDER_ID
INNER JOIN PRODUCTS 
ON ORDER_DETAILS.PRODUCT_ID = PRODUCTS.PRODUCT_ID 
GROUP BY CUSTOMERS.CUSTOMER_ID, CUSTOMERS.COMPANY_NAME;
